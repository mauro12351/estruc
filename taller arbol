#include <iostream>
#include <string>
#include <cstdlib> // Incluir la biblioteca para usar malloc
using namespace std;

struct Estudiante {
    int codigo;
    string nombres;
    string apellidos;
    string fechaNacimiento; 
    Estudiante *izq;
    Estudiante *der;
    Estudiante *subArbolFecha;
    Estudiante *padre;
};

Estudiante *raizCodigo = null; // para encontrar el estudiante + joven

Estudiante* encontrarMasJoven(Estudiante* estudiante) {
    while(estudiante && estudiante->izq != null)
        estudiante = estudiante->izq;
    return estudiante;
}

void reemplazar(Estudiante* a, Estudiante* b) { // cambiar de estudiante
    if(a->padre == null)
        raizCodigo = b;
    else if(a == a->padre->izq)
        a->padre->izq = b;
    else
        a->padre->der = b;
    if(b != null)
        b->padre = a->padre;
}

void destruirNodo(Estudiante* estudiante) { //para eliminar estudiante
    delete estudiante;
}
void eliminarEstudiante(Estudiante*estudianteAEliminar){
    if(estudianteAEliminar->izq==null)
       reemplazar(estudianteAEliminar,estudianteAEliminar->der);
    else if(estudianteAEliminar->der==null)
       reemplazar(estudianteAEliminar,estudianteAEliminar->izq);
    else{ 
        Estudiante*temp= encontrarMasJoven(estudianteAEliminar->der);
    if(temp->padre!=estudianteAEliminar){
        reemplazar(temp, temp->der);
         temp->der=estudianteAEliminar->der;
         temp->der->padre=temp;
}
         reemplazar(estudianteAEliminar,temp);
         temp->izq=estudianteAEliminar->izq;
         temp->izq->padre=temp;
}
 destruirNodo(estudianteAEliminar);// eliminar estudiante
}
 void eliminar(int codigo){
       Estudiante*temp=raizCodigo;
    while(temp!= null){
    if(codigo < temp-> codigo)
       temp= temp->izq;
    else if (codigo > temp-> codigo)
       temp= temp->der; 
    else {
       eliminarEstudiante(temp);
          return;
  }
}
 cout<<"El estudiante con codigo"<<codigo<<"no se encuentra en el sistema."<<endl;
}
 void insertarPorCodigo(Estudiante*&raiz, Estudiante* nuevo){ // insertar estudiante al arbool
    if(raiz==null){
       raiz= nuevo;
}   else{
    if(nuevo->codigo<raiz->codigo){
       insertarPorCodigo(raiz->izq,nuevo);
       raiz->izq->padre = raiz;
}   else{
       insertarPorCodigo(raiz->der,nuevo);
       raiz->der->padre = raiz;
     }
   }
}
 void insertarPorFecha(Estudiante*&raiz,Estudiante* nuevo){
    if(raiz==null){
       raiz= nuevo;
   }else {
    if (nuevo->fechaNacimiento<raiz->fechaNacimiento) {
        insertarPorFecha(raiz->izq,nuevo);
   }else {
         insertarPorFecha(raiz->der,nuevo);
   }
  }
}
